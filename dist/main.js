(()=>{"use strict";const e=document.querySelectorAll(".slider__img"),t=document.querySelectorAll(".slider__dot");let o=0;function n(){e.forEach((e=>{e.style.display="none"})),o++,o>e.length&&(o=1),t.forEach((e=>{e.className=e.className.replace(" active-dot","")})),e[o-1].style.display="block",t[o-1].className+=" active-dot",setTimeout(n,5e3)}const c=document.querySelector(".categories__list"),s=document.querySelectorAll(".categories__list-item");const a=document.querySelector(".book-cards"),i=[];function r(e,t){let o="";console.log(e),e.items.forEach((e=>{const t=`\n        <div class="book-cards__card">\n            <img src="${e.volumeInfo.imageLinks.thumbnail?e.volumeInfo.imageLinks.thumbnail:"/src/img/cards-img/imagePlaceholder.png"}" class="book-cards__img"/>\n            <div class="book-cards__text">\n                <p class="book-cards__author">${e.volumeInfo.authors?e.volumeInfo.authors:"author not specified"}</p>\n                <p class="book-cards__title">${e.volumeInfo.title}</p>\n                <div class="rating">\n                    <div class="rating__body">\n                        <div class="rating__active" style="width: ${e.volumeInfo.averageRating/.05}%"></div>  \n                        <p class="rating__review">${e.volumeInfo.ratingsCount?e.volumeInfo.ratingsCount:0} review</p>    \n                    </div>\n                </div>\n                <p class="book-cards__description">${e.volumeInfo.description}</p>\n                <p class="book-cards__price">${e.saleInfo.retailPrice?e.saleInfo.retailPrice.amount+" "+e.saleInfo.retailPrice.currencyCode:"Not for sale"}</p>\n                <button class="${e.saleInfo.retailPrice?"book-cards__btn":"disabled-btn"}">buy now</button>\n            </div>\n        </div>`;o+=t})),t.innerHTML=o,function(e){const t=document.querySelectorAll(".book-cards__btn"),o=document.querySelector(".cart-counter");let n;m(),t.forEach((t=>{t.addEventListener("click",(c=>{n=function(e,t){let o;return o=e.items.find((e=>{if(e.volumeInfo.title===t.target.parentNode.querySelector(".book-cards__title").textContent)return e})),o.id}(e,c),t.classList.contains("book-cards__btn")?(!function(e){i.includes(e)||(i.push(e),u(i))}(n),t.classList.replace("book-cards__btn","in-cart-btn"),t.innerText="in the cart"):t.classList.contains("in-cart-btn")&&(!function(e){i.includes(e)&&(i.splice(i.indexOf(e),1),function(e,t){const o=localStorage.getItem(t).split(",");o.splice(o.indexOf(e),1),u(o)}(e,"books"))}(n),t.classList.replace("in-cart-btn","book-cards__btn"),t.innerText="buy now"),o.classList.contains("cart-counter-visible")||o.classList.add("cart-counter-visible"),o.innerText=i.length,"0"===o.textContent&&o.classList.remove("cart-counter-visible")})),(i.includes(d(e,t))||m().includes(d(e,t)))&&(t.classList.replace("book-cards__btn","in-cart-btn"),t.innerText="in the cart")}))}(e)}function l(e,t,o){fetch(`https://www.googleapis.com/books/v1/volumes?q="subject:${e}"&key=AIzaSyCQbSqaHFYuQo8gpB5hi-3wu4jOa22C_MY&printType=books&startIndex=${o}&maxResults=6&orderBy=newest&langRestrict=en`).then((e=>e.json())).then((e=>{r(e,t)})).catch((e=>e))}function d(e,t){return e.items.find((e=>{if(e.volumeInfo.title===t.parentElement.querySelector(".book-cards__title").textContent)return e})).id}function u(e){localStorage.setItem("books",e)}function m(){const e=document.querySelector(".cart-counter"),t=localStorage.getItem("books").split(",");return localStorage.getItem("books")&&(e.classList.add("cart-counter-visible"),e.innerText=t.length),t}const b=document.querySelector(".btn-wrapper__load-btn");function v(){let e=6;b.addEventListener("click",(()=>{!function(){const e=document.createElement("div");b.parentElement.prepend(e),e.classList.add("load-block")}();l(c.querySelector(".active-category").textContent,document.querySelector(".load-block"),e),e+=6}))}window.addEventListener("DOMContentLoaded",(()=>{n(),t.forEach(((o,n)=>{o.addEventListener("click",(o=>{t.forEach((e=>{e.classList.contains("active-dot")&&e.classList.remove("active-dot")})),o.target.classList.add("active-dot"),e.forEach((e=>{e.style.display="none"})),e[n].style.display="block"}))})),s[0].classList.add("active-category"),c.addEventListener("click",(e=>{e.target.classList.contains("categories__list-item")&&(s.forEach((e=>{e.classList.contains("active-category")&&e.classList.remove("active-category")})),e.target.classList.add("active-category"));const t=document.querySelector(".btn-wrapper").querySelectorAll(".load-block");t.length>0&&t.forEach((e=>{e.remove()}))})),l(s[0].outerText,a,0),c.addEventListener("click",(e=>{l(e.target.outerText,a,0)})),v()}))})();